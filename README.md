# Backend-сервис для Блога

Этот проект представляет собой backend-сервис для управления постами и комментариями в блоге компании. Он реализован на Laravel и предоставляет RESTful API для всех необходимых CRUD-операций, аутентификации, управления доступом на основе ролей и сбора аналитики.

## Технический стек

*   **PHP:** 8.2+
*   **Фреймворк:** Laravel 12
*   **База данных:** PostgreSQL
*   **Кеш:** Redis
*   **Окружение:** Docker / Docker Compose

## Быстрый старт

Для запуска проекта на локальной машине необходимо выполнить следующие шаги. Убедитесь, что у вас установлены **Docker** и **Docker Compose**.

1.  **Клонируйте репозиторий**
    ```bash
    git clone git@github.com:Alexeysmlk/miniback.git
    cd miniback
    ```

2.  **Создайте и настройте файл окружения**
    Скопируйте файл `.env.example` и убедитесь, что переменные соответствуют настройкам в `compose.yml` (например, `DB_HOST=pgsql`).
    ```bash
    cp .env.example .env
    ```

3.  **Соберите и запустите Docker-контейнеры**
    Эта команда скачает образы, соберет контейнеры и запустит их в фоновом режиме.
    ```bash
    docker-compose up -d --build
    ```

4.  **Установите зависимости и сгенерируйте ключ**
    ```bash
    docker-compose exec app composer install
    docker-compose exec app php artisan key:generate
    ```

5.  **Запустите миграции и сидеры**
    Эта команда создаст структуру базы данных и заполнит ее начальными данными (роли, разрешения, тестовые пользователи и посты).
    ```bash
    docker-compose exec app php artisan migrate:fresh --seed
    ```

После выполнения всех шагов проект будет доступен по адресу `http://localhost:8080`.

### Учетные данные по умолчанию

Сидер создает несколько пользователей для тестирования. Главный администратор:
*   **Email:** `admin@example.com`
*   **Пароль:** `admin123`

## Ключевые API Эндпоинты

Все эндпоинты, кроме регистрации и входа, требуют `Authorization: Bearer <token>` заголовок.

#### Аутентификация
*   `POST /api/auth/register` - Регистрация нового пользователя.
*   `POST /api/auth/login` - Вход в систему, получение токена.
*   `POST /api/auth/logout` - Выход из системы.
*   `GET /api/user` - Получение данных текущего пользователя.

#### Посты
*   `GET /api/posts` - Получение списка постов (с пагинацией, фильтрацией и поиском).
*   `POST /api/posts` - Создание нового поста.
*   `GET /api/posts/{post}` - Получение одного поста.
*   `PATCH /api/posts/{post}` - Обновление поста.
*   `DELETE /api/posts/{post}` - Удаление поста.

#### Комментарии
*   `GET /api/posts/{post}/comments` - Получение комментариев к посту.
*   `POST /api/posts/{post}/comments` - Создание нового комментария.
*   `PATCH /api/comments/{comment}` - Обновление комментария.
*   `DELETE /api/comments/{comment}` - Удаление комментария.

#### Управление и Справочники
*   `PATCH /api/users/{user}/role` - Изменение роли пользователя (только для администратора).
*   `GET /api/meta/roles` - Получение списка всех доступных ролей.

#### Аналитика
*   `GET /api/analytics/posts` - Статистика по постам.
*   `GET /api/analytics/comments` - Статистика по комментариям.
*   `GET /api/analytics/users` - Статистика по пользователям.

---
